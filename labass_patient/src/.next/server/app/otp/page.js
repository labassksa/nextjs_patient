(()=>{var e={};e.id=636,e.ids=[636],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},2361:e=>{"use strict";e.exports=require("events")},358:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},1918:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>h,originalPathname:()=>x,pages:()=>m,routeModule:()=>f,tree:()=>p});var a=s(1698);s(4555),s(7121);var n=s(2933),o=s(1409),i=s(7301),l=s.n(i),c=s(7101),u={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(u[e]=()=>c[e]);s.d(t,u);var d=e([a]);a=(d.then?(await d)():d)[0];let p=["",{children:["otp",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1698)),"/Users/yazeed/nextjs_patient/labass_patient/src/app/otp/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7977))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,4555)),"/Users/yazeed/nextjs_patient/labass_patient/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,7121,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7977))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],m=["/Users/yazeed/nextjs_patient/labass_patient/src/app/otp/page.tsx"],x="/otp/page",h={require:s,loadChunk:()=>Promise.resolve()},f=new n.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/otp/page",pathname:"/otp",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:p}});r()}catch(e){r(e)}})},7854:()=>{},2107:(e,t,s)=>{Promise.resolve().then(s.bind(s,3693))},8115:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2383,23)),Promise.resolve().then(s.t.bind(s,2928,23)),Promise.resolve().then(s.t.bind(s,983,23)),Promise.resolve().then(s.t.bind(s,7489,23)),Promise.resolve().then(s.t.bind(s,5232,23)),Promise.resolve().then(s.t.bind(s,6534,23))},2274:(e,t,s)=>{"use strict";s.d(t,{m:()=>a});var r=s(1784);let a=async e=>{try{let t=e.startsWith("+966")?e:`+966${e}`,s=process.env.NEXT_PUBLIC_API_URL,a=await r.Z.post(`${s}/send-otp`,{phoneNumber:t,role:"patient"});if(200===a.status)return{success:!0};return{success:!1,message:"Unexpected response status code"}}catch(e){if(r.Z.isAxiosError(e)&&e.response&&e.response.data)return{success:!1,message:e.response.data.error||"حدث خطأ ، حاول مرة أخرى"};return{success:!1,message:"حدث خطأ ، حاول مرة أخرى"}}}},3693:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(7657),a=s(7123);let n=(0,a.forwardRef)(({value:e,index:t,onChange:s,autoFocus:a},n)=>r.jsx("input",{type:"tel",maxLength:1,value:e,autoFocus:a,onChange:e=>{let r=e.target.value;r.trim().length<=1&&!isNaN(Number(r))&&s(r,t)},className:"w-16 h-16 m-2 text-center text-3xl text-black border rounded-lg focus:border-custom-green  focus:outline-none focus:shadow-md",autoComplete:"one-time-code",inputMode:"numeric",pattern:"[0-9]*",ref:n}));n.displayName="OTPInput";var o=s(1774);let i=({phoneNumber:e})=>(0,r.jsxs)("div",{className:"text-center mt-20 mx-4",children:[r.jsx("h2",{className:"text-xl font-bold",children:"الرجاء إدخال الرمز المكون من 4 ارقام"}),(0,r.jsxs)("p",{className:"text-gray-600 m-4",children:["تم إرسال الرمز الى الرقم"," ",r.jsx("span",{className:"font-bold",children:e})," الرجاء ادخال الرمز المكون من ٤ أرقام"]})]}),l=({onResend:e})=>{let[t,s]=(0,a.useState)(10);return(0,a.useEffect)(()=>{let e=setInterval(()=>{s(e=>e>0?e-1:0)},1e3);return()=>clearInterval(e)},[]),r.jsx("div",{className:"text-center mt-4",children:(0,r.jsxs)("p",{className:"text-gray-600",children:["لم استلم الكود"," ",(0,r.jsxs)("span",{className:`text-blue-600 cursor-pointer ${t>0?"pointer-events-none text-gray-400":""}`,onClick:()=>{0===t&&(e(),s(60))},children:["اضغط هنا لاعادة ارساله ",t>0&&`(${t} ثانية)`]})]})})};var c=s(6426),u=s(1784);let d=async(e,t,s)=>{try{let r=process.env.NEXT_PUBLIC_API_URL,a=await u.Z.post(`${r}/verifyOTPandLogin`,{role:e,phoneNumber:t,otpcode:s});if(200!==a.status)return{success:!1,message:"Unexpected response status code"};{let e=a.data.tokens.token;return console.log(`the token inside verify otp method ${e}`),localStorage.setItem("labass_token",e),{success:!0,token:e}}}catch(e){if(!u.Z.isAxiosError(e)||!e.response||!e.response.data||!e.response.data.error&&!e.response.data.errors)return{success:!1,message:"حدث خطأ ، حاول مرة أخرى"};if(e.response.data.error)return{success:!1,message:e.response.data.error};if(e.response.data.errors)return{success:!1,message:e.response.data.errors.map(e=>e.msg).join(", ")}}};var p=s(2274);let m=()=>{let[e,t]=(0,a.useState)(["","","",""]),s=(0,a.useRef)([null,null,null,null]),[u,m]=(0,a.useState)(null),[x,h]=(0,a.useState)(null),f=(0,c.useRouter)();(0,a.useEffect)(()=>{m(new URLSearchParams(window.location.search).get("phoneNumber"))},[]),(0,a.useEffect)(()=>{e.every(e=>1===e.length)&&v()},[e.join("")]);let g=(r,a)=>{let n=[...e];n[a]=r,t(n),r&&a<3?s.current[a+1]?.focus():!r&&a>0&&s.current[a-1]?.focus()},v=async()=>{if(!u){console.error("Phone number is missing in the OTP page.");return}let t=e.join("");try{let e=await d("patient",u,t);e&&e.success?(console.log("OTP Verified:",e),f.push("/")):e?(h(e.message),console.error("Failed to verify OTP:",e.message)):(h("حدث خطأ ، حاول مرة أخرى"),console.error("Failed to verify OTP: Result is undefined"))}catch(e){h("حدث خطأ ، حاول مرة أخرى"),console.error("Failed to verify OTP:",e)}},b=async()=>{if(!u){console.error("Phone number is missing in the OTP page.");return}try{let e=await (0,p.m)(u);e&&e.success?(t(["","","",""]),s.current[0]?.focus(),h(null)):e?(h(e.message),console.error("Failed to resend OTP:",e.message)):(h("حدث خطأ ، حاول مرة أخرى"),console.error("Failed to resend OTP: Result is undefined"))}catch(e){h("حدث خطأ ، حاول مرة أخرى"),console.error("Failed to resend OTP:",e)}};return r.jsx("div",{className:"bg-white min-h-screen",children:(0,r.jsxs)("div",{className:"flex flex-col justify-between",children:[r.jsx(o.default,{title:"التحقق",showBackButton:!0}),u?r.jsx(i,{phoneNumber:u}):null,r.jsx("div",{className:"flex mt-10 justify-center",children:e.map((e,t)=>r.jsx(n,{value:e,index:t,onChange:g,autoFocus:0===t,ref:e=>s.current[t]=e},t))}),x&&r.jsx("div",{className:"text-red-500 text-sm m-2 text-center",children:x}),r.jsx(l,{onResend:b})]})})}},1774:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var r=s(7657);s(7123);var a=s(6426),n=s(2556);let o=({title:e,showBackButton:t=!1})=>{let s=(0,a.useRouter)();return(0,r.jsxs)("div",{className:"fixed top-0 w-full bg-white p-4 flex items-center justify-between z-10",children:[r.jsx("h1",{className:"text-lg text-gray-500 font-normal flex-grow text-center",children:e}),t&&r.jsx("button",{onClick:()=>s.back(),className:"ml-2",children:r.jsx(n.Z,{className:"h-5 w-5 text-gray-500","aria-hidden":"true"})})]})}},4555:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>a});var r=s(5180);s(6004);let a={title:"Next.js",description:"Generated by Next.js"};function n({children:e}){return r.jsx("html",{lang:"ar",children:r.jsx("body",{children:e})})}},1698:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>e});var a=s(1903);let e=(await (0,a.createProxy)(String.raw`/Users/yazeed/nextjs_patient/labass_patient/src/app/otp/page.tsx`)).default;r()}catch(e){r(e)}},1)},7977:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(9047);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},6004:()=>{},2556:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(7123);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z",clipRule:"evenodd"}))})}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[208,95,47,968,784],()=>s(1918));module.exports=r})();